<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>TCSS 142 Project 3 Tester ‚Äì EmotionAnalyzer</title>
<!--
  Easter eggs and fun behavior in this tester:

  1) Late-night note
     - If the current time is between 11:00 PM and 5:00 AM, the hero meta shows:
       "It is pretty late. Fix a couple of bugs, then please get some rest."
     - If the current time is between 5:00 AM and 9:00 AM, it shows:
       "Early debugging squad. Remember breakfast and water too."

  2) Run counter based hints
     - A run counter is stored in localStorage under the key "ea-run-count".
     - On each Run tests click, runCount increments and the hint changes:
       ‚Ä¢ On run 3: "Third run already. Debugging is just science with vibes."
       ‚Ä¢ On run 7: "Seven runs. You and this tester are basically lab partners now."
       ‚Ä¢ On runCount greater than 10 during late-night hours:
         "Many late runs logged. Please stretch your hands and plan a sleep break."

  3) Code content based hints
     - If the pasted code contains "todo" (case-insensitive):
       Hint: "Spotted TODOs in your code. Future you is counting on present you."
     - If the pasted code contains "bug":
       Hint: "You even wrote 'bug' in the code. Very honest, very real."
     - If the file has more than 250 lines:
       Hint: "Big file energy. This analyzer has N lines of feelings."
     - If the code contains "thanks faiz":
       Hint: "TA appreciation detected. The tester thinks you are cool."

  4) General hint rotation
     - When no time or code based condition is triggered, funHint cycles over:
       ‚Ä¢ "Try a tiny input file whose scores you can compute by hand."
       ‚Ä¢ "If scores look strange, print intermediate values for a single line."
       ‚Ä¢ "Keep one version that worked as a backup before big changes."
       ‚Ä¢ "Neutrals matter too. They keep the mood balanced."

  5) Template insertion nudge
     - When Insert template is used:
       Status: "Template inserted"
       Hint: "Fill in each method to match the handout. Start with normalizeToken and classify."

  6) Secret TA note on output
     - Double click on the output area:
       funHint becomes:
       "Secret note from your TA: the tester is strict now so Canvas can be less scary later."

  7) Dynamic document title
     - While tests are running:
       Title: "Running tests - TCSS 142 Project 3"
     - On error:
       Title: "Check output - TCSS 142 Project 3"
     - On ready state:
       Title: "Ready - TCSS 142 Project 3 Tester"
     - Default:
       Title: "TCSS 142 Project 3 Tester ‚Äì EmotionAnalyzer" (browser tab label)

  8) Visual easter eggs and background effects
     - Husky themed blob cursor trail that follows the pointer.
     - Floating ‚Äúaurora‚Äù particle field in the background.
     - Old school bouncing DVD logo behind the main shell.

  9) Theme memory
     - Dark and light theme toggle with icon change.
     - Theme preference is stored in localStorage under "ea-theme" so the site remembers the mode.
  -->

  <!--  -->


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root {
  --bg-gradient: radial-gradient(circle at top, #181c3a 0%, #050810 55%, #02040a 100%);
  --bg-surface: rgba(15, 23, 42, 0.9);
  --accent: #4ade80;
  --accent-soft: rgba(74, 222, 128, 0.15);
  --accent-strong: #22c55e;
  --accent-danger: #fb7185;
  --accent-info: #38bdf8;
  --card-bg: rgba(17, 24, 39, 0.88);
  --border-subtle: rgba(148, 163, 184, 0.4);
  --text-main: #e5e7eb;
  --text-muted: #9ca3af;
  --shadow-strong: 0 22px 60px rgba(0, 0, 0, 0.75);
}

/* Light theme overrides */
body[data-theme="light"] {
  --bg-gradient: radial-gradient(circle at top, #e0f2fe 0%, #f8fafc 55%, #e5e7eb 100%);
  --bg-surface: rgba(248, 250, 252, 0.92);
  --accent: #16a34a;
  --accent-soft: rgba(34, 197, 94, 0.14);
  --accent-strong: #22c55e;
  --accent-danger: #e11d48;
  --accent-info: #0ea5e9;
  --card-bg: rgba(255, 255, 255, 0.9);
  --border-subtle: rgba(148, 163, 184, 0.55);
  --text-main: #020617;
  --text-muted: #6b7280;
  --shadow-strong: 0 18px 45px rgba(15, 23, 42, 0.2);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  color: var(--text-main);
  background: var(--bg-gradient);
  display: flex;
  align-items: stretch;
  justify-content: center;
  position: relative;
  overflow-x: hidden;
}

/* Animated background layer */
body::before,
body::after {
  content: "";
  position: fixed;
  inset: -40%;
  pointer-events: none;
  z-index: -2;
  background:
    radial-gradient(circle at 10% 20%, rgba(56, 189, 248, 0.25) 0, transparent 45%),
    radial-gradient(circle at 80% 0%, rgba(168, 85, 247, 0.24) 0, transparent 50%),
    radial-gradient(circle at 50% 100%, rgba(34, 197, 94, 0.22) 0, transparent 55%);
  filter: blur(22px);
  opacity: 0.95;
  transform: translate3d(0, 0, 0);
  animation: auroraShift 26s ease-in-out infinite alternate;
}
body::after {
  animation-duration: 38s;
  mix-blend-mode: screen;
  opacity: 0.7;
}

@keyframes auroraShift {
  0%   { transform: translate3d(-3%, -2%, 0) scale(1.02); }
  50%  { transform: translate3d(3%, 2%, 0)  scale(1.06); }
  100% { transform: translate3d(-2%, 4%, 0) scale(1.03); }
}

/* Floating particles */
.particle-layer {
  position: fixed;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
  z-index: -1;
}
.particle {
  position: absolute;
  width: 2px;
  height: 2px;
  border-radius: 999px;
  background: rgba(148, 163, 184, 0.6);
  box-shadow: 0 0 10px rgba(148, 163, 184, 0.7);
  opacity: 0.0;
  animation: floatParticle linear infinite;
}
@keyframes floatParticle {
  0%   { transform: translate3d(var(--x-start), 110%, 0); opacity: 0; }
  10%  { opacity: 0.65; }
  90%  { opacity: 0.65; }
  100% { transform: translate3d(var(--x-end), -10%, 0); opacity: 0; }
}

/* Main layout */

.main-shell {
  width: 100%;
  max-width: 1120px;
  margin: 26px auto;
  padding: 16px;
  animation: shellEntrance 0.6s ease-out;
  position: relative;
  z-index: 1; /* sits above blob + particles + DVD */
}

@keyframes shellEntrance {
  from { opacity: 0; transform: translateY(18px) scale(0.99); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}

.hero {
  text-align: left;
  margin-bottom: 20px;
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  align-items: center;
  justify-content: space-between;
}

.hero-text {
  max-width: 640px;
}

.title-chip {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid var(--accent-soft);
  background: radial-gradient(circle at top left, rgba(74, 222, 128, 0.18), rgba(15, 23, 42, 0.9));
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--accent);
  backdrop-filter: blur(18px);
  box-shadow: 0 10px 40px rgba(15, 23, 42, 0.7);
  cursor: pointer;
}

.title-chip span.icon {
  font-size: 14px;
}

.hero h1 {
  font-size: clamp(26px, 4vw, 34px);
  margin: 10px 0 4px 0;
  font-weight: 700;
}

.hero h1 span {
  background: linear-gradient(120deg, #4ade80, #22d3ee, #a855f7);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

.hero-subtitle {
  font-size: 14px;
  color: var(--text-muted);
  max-width: 580px;
}

.hero-subtitle code {
  font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  padding: 2px 6px;
  border-radius: 6px;
  background: rgba(15, 23, 42, 0.9);
  border: 1px solid rgba(148, 163, 184, 0.4);
}

.hero-meta {
  text-align: right;
  font-size: 12px;
  color: var(--text-muted);
}

.hero-meta div {
  opacity: 0.9;
}

/* Theme Toggle */

.theme-toggle {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid var(--border-subtle);
  background: rgba(15, 23, 42, 0.92);
  color: var(--text-muted);
  font-size: 11px;
  cursor: pointer;
  transition: background 0.15s ease-out, border-color 0.15s ease-out, transform 0.15s ease-out, box-shadow 0.15s ease-out;
}
body[data-theme="light"] .theme-toggle {
  background: rgba(248, 250, 252, 0.9);
}
.theme-toggle:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 30px rgba(15, 23, 42, 0.4);
}

/* Layout */

.shell-grid {
  display: grid;
  grid-template-columns: minmax(0, 1.02fr) minmax(0, 0.98fr);
  gap: 16px;
}

@media (max-width: 900px) {
  .shell-grid {
    grid-template-columns: minmax(0, 1fr);
  }
  .hero {
    text-align: left;
  }
}

/* Left card */

.info-card {
  border-radius: 20px;
  background: var(--card-bg);
  border: 1px solid var(--border-subtle);
  padding: 18px 20px 16px;
  box-shadow: var(--shadow-strong);
  backdrop-filter: blur(22px);
  position: relative;
  overflow: hidden;
  animation: cardInLeft 0.7s ease-out;
}

.info-card::before {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 0% 0%, rgba(56, 189, 248, 0.09), transparent 55%);
  opacity: 0.9;
  pointer-events: none;
}

@keyframes cardInLeft {
  from { opacity: 0; transform: translateY(16px) translateX(-8px); }
  to   { opacity: 1; transform: translateY(0) translateX(0); }
}

.info-card h2 {
  margin: 0 0 8px;
  font-size: 16px;
}

.info-card p {
  margin: 4px 0;
  font-size: 13px;
  color: var(--text-muted);
}

.info-pill-row {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
}

.info-pill {
  font-size: 11px;
  padding: 4px 8px;
  border-radius: 999px;
  border: 1px solid rgba(75, 85, 99, 0.9);
  background: rgba(15, 23, 42, 0.96);
  display: inline-flex;
  align-items: center;
  gap: 5px;
}

body[data-theme="light"] .info-pill {
  background: rgba(248, 250, 252, 0.96);
}

.info-pill span.bullet {
  width: 7px;
  height: 7px;
  border-radius: 999px;
  background: var(--accent);
}

.info-mini-list {
  list-style: none;
  padding-left: 0;
  margin: 10px 0 0;
  font-size: 12px;
  color: var(--text-muted);
}

.info-mini-list li {
  margin-bottom: 4px;
}

/* Canvas link row */

.info-link-row {
  margin-top: 12px;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--text-muted);
}

.info-link-pill {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 5px 10px;
  border-radius: 999px;
  border: 1px solid rgba(56, 189, 248, 0.7);
  background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.18), rgba(15, 23, 42, 0.95));
  color: #e0f2fe;
  text-decoration: none;
  font-size: 11px;
  letter-spacing: 0.03em;
  text-transform: uppercase;
  cursor: pointer;
  transition: transform 0.12s ease-out, box-shadow 0.12s ease-out, background 0.12s ease-out;
}
body[data-theme="light"] .info-link-pill {
  background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.14), #e0f2fe);
  color: #0f172a;
}
.info-link-pill:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 30px rgba(56, 189, 248, 0.45);
}

/* Right side */

.tester-card {
  border-radius: 20px;
  background: var(--card-bg);
  border: 1px solid var(--border-subtle);
  padding: 18px 20px 16px;
  box-shadow: var(--shadow-strong);
  backdrop-filter: blur(24px);
  display: flex;
  flex-direction: column;
  gap: 10px;
  position: relative;
  overflow: hidden;
  animation: cardInRight 0.75s ease-out;
}

.tester-card::before {
  content: "";
  position: absolute;
  inset: -40%;
  background: conic-gradient(from 210deg, rgba(34, 197, 94, 0.05), rgba(56, 189, 248, 0.09), rgba(168, 85, 247, 0.06), transparent 60%);
  mix-blend-mode: screen;
  opacity: 0.9;
  animation: cardGlow 16s linear infinite;
  pointer-events: none;
}
@keyframes cardGlow {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}
@keyframes cardInRight {
  from { opacity: 0; transform: translateY(18px) translateX(8px); }
  to   { opacity: 1; transform: translateY(0) translateX(0); }
}

.tester-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  font-size: 12px;
  position: relative;
  z-index: 1;
}

.status-pill {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 3px 9px;
  border-radius: 999px;
  background: rgba(15, 23, 42, 0.95);
  border: 1px solid rgba(55, 65, 81, 0.95);
  color: var(--text-muted);
}
body[data-theme="light"] .status-pill {
  background: rgba(248, 250, 252, 0.96);
  border-color: rgba(148, 163, 184, 0.8);
}

.status-dot {
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: var(--accent);
  box-shadow: 0 0 10px rgba(74, 222, 128, 0.8);
}

.small-label {
  font-size: 11px;
  color: var(--text-muted);
}

/* textarea / input */

textarea {
  width: 100%;
  height: 270px;
  background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.97), #020617);
  color: var(--text-main);
  font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 13px;
  border: 1px solid rgba(55, 65, 81, 0.95);
  border-radius: 10px;
  padding: 10px 11px;
  resize: vertical;
  outline: none;
  box-shadow: inset 0 0 0 1px rgba(15, 23, 42, 0.9);
  position: relative;
  z-index: 1;
}
body[data-theme="light"] textarea {
  background: radial-gradient(circle at top left, #f9fafb, #e5e7eb);
  border-color: rgba(148, 163, 184, 0.7);
}
textarea::placeholder {
  color: rgba(148, 163, 184, 0.8);
}
textarea:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.5), 0 0 40px rgba(22, 163, 74, 0.4);
}

/* buttons */

.button-row {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 4px;
  position: relative;
  z-index: 1;
}

button {
  border: none;
  border-radius: 999px;
  padding: 8px 18px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 7px;
  transition: transform 0.12s ease-out, box-shadow 0.12s ease-out, background 0.12s ease-out, opacity 0.12s;
  letter-spacing: 0.02em;
  position: relative;
  overflow: hidden;
}

button span.icon {
  font-size: 15px;
}

button.primary {
  background: linear-gradient(135deg, var(--accent-strong), #22d3ee, #a855f7);
  color: #020617;
  box-shadow: 0 8px 25px rgba(34, 197, 94, 0.5);
}
button.primary::after {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 0% 0%, rgba(255, 255, 255, 0.35), transparent 55%);
  opacity: 0;
  transition: opacity 0.12s ease-out;
}
button.primary:hover::after {
  opacity: 0.55;
}

button.secondary {
  background: rgba(15, 23, 42, 0.96);
  border: 1px solid rgba(75, 85, 99, 0.9);
  color: var(--text-main);
}
body[data-theme="light"] button.secondary {
  background: rgba(248, 250, 252, 0.96);
}

button.ghost {
  background: transparent;
  border: 1px dashed rgba(75, 85, 99, 0.9);
  color: var(--text-muted);
}
body[data-theme="light"] button.ghost {
  border-style: dashed;
}

button:hover {
  transform: translateY(-1px) translateZ(0);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.55);
  opacity: 0.98;
}

button:active {
  transform: translateY(0);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.55);
}

/* Run button loading state */

button.primary.is-loading {
  cursor: wait;
  opacity: 0.92;
  box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.35), 0 0 34px rgba(34, 197, 94, 0.65);
}
button.primary.is-loading span.icon {
  animation: spinLoader 0.9s linear infinite;
}
@keyframes spinLoader {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}

/* output card */

.output-card {
  margin-top: 18px;
  border-radius: 20px;
  background: var(--card-bg);
  border: 1px solid var(--border-subtle);
  padding: 16px 20px 14px;
  box-shadow: var(--shadow-strong);
  backdrop-filter: blur(22px);
  position: relative;
  overflow: hidden;
  animation: cardInBottom 0.8s ease-out;
}
.output-card::before {
  content: "";
  position: absolute;
  inset: -40%;
  background: radial-gradient(circle at 20% 0%, rgba(56, 189, 248, 0.09), transparent 55%);
  mix-blend-mode: screen;
  opacity: 0.9;
  pointer-events: none;
}
@keyframes cardInBottom {
  from { opacity: 0; transform: translateY(22px); }
  to   { opacity: 1; transform: translateY(0); }
}

.output-block {
  margin-top: 4px;
  position: relative;
  z-index: 1;
}

.output-label-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 11px;
  color: var(--text-muted);
  margin-bottom: 4px;
}

.output-label-row span.right {
  font-style: italic;
}

/* Make output wide and scrollable without wrapping */
pre {
  width: 100%;
  margin: 0;
  background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.97), #020617);
  text-align: left;
  padding: 10px;
  overflow-x: auto;
  overflow-y: auto;
  white-space: pre; /* no wrapping, keep lines full */
  border-radius: 10px;
  border: 1px solid rgba(55, 65, 81, 0.95);
  font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  color: var(--text-main);
  max-height: 280px;
}
body[data-theme="light"] pre {
  background: radial-gradient(circle at top left, #f9fafb, #e5e7eb);
  border-color: rgba(148, 163, 184, 0.75);
}

/* footer mini */

.footer-note {
  margin-top: 12px;
  text-align: center;
  font-size: 11px;
  color: var(--text-muted);
  opacity: 0.9;
  position: relative;
  padding-top: 10px;
}
.footer-note::before {
  content: "";
  position: absolute;
  top: 0;
  left: 15%;
  right: 15%;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(148, 163, 184, 0.6), transparent);
  box-shadow: 0 0 18px rgba(148, 163, 184, 0.5);
}

/* Utility classes */

.kb-shortcuts {
  margin-top: 6px;
  font-size: 11px;
  color: var(--text-muted);
}

kbd {
  font-family: "JetBrains Mono", ui-monospace, monospace;
  font-size: 11px;
  padding: 2px 5px;
  border-radius: 4px;
  border: 1px solid rgba(148, 163, 184, 0.6);
  background: rgba(15, 23, 42, 0.9);
  color: var(--text-main);
}
body[data-theme="light"] kbd {
  background: rgba(248, 250, 252, 0.96);
}

.hidden {
  display: none !important;
}

/* ---------- Husky Purple Blob Cursor Layer ---------- */

.blob-layer{
  position:fixed;
  inset:0;
  pointer-events:none;
  filter:url(#husky-blob);
  z-index:0;
  overflow:hidden;
}

.blob-dot{
  position:absolute;
  top:0;
  left:0;
  border-radius:50%;
  background:radial-gradient(circle at 30% 20%, #b28cff 0, #6a33d9 40%, #32006e 100%);
  box-shadow:0 25px 55px rgba(0,0,0,0.85);
  opacity:0.9;
  transform:translate3d(-50%, -50%, 0);
  will-change:transform;
}

.blob-dot:nth-child(1){ width:55px;  height:55px; }
.blob-dot:nth-child(2){ width:90px;  height:90px; }
.blob-dot:nth-child(3){ width:120px; height:120px; }
.blob-dot:nth-child(4){ width:140px; height:140px; }
.blob-dot:nth-child(5){ width:100px; height:100px; }
.blob-dot:nth-child(6){ width:70px;  height:70px; }

/* ---------- DVD Logo Layer ---------- */

.dvd-layer{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0; /* same depth as blob; both under main-shell */
}

.dvd-x{
  position:absolute;
  width:110px;
  height:66px;
  animation: dvd-x-move 6.5s linear infinite alternate;
}

.dvd-y{
  width:110px;
  height:66px;
  animation: dvd-y-move 3.5s linear infinite alternate;
}

@keyframes dvd-x-move{
  0%   { transform: translateX(0); }
  100% { transform: translateX(calc(100vw - 110px)); }
}

@keyframes dvd-y-move{
  0%   { transform: translateY(0); }
  100% { transform: translateY(calc(100vh - 66px)); }
}

/* ---------- Toast and confetti ---------- */

.toast{
  position:fixed;
  left:50%;
  bottom:18px;
  transform:translateX(-50%) translateY(140%);
  background:rgba(15,23,42,0.98);
  color:var(--text-main);
  border-radius:999px;
  padding:9px 16px;
  border:1px solid var(--accent-info);
  box-shadow:0 18px 45px rgba(0,0,0,0.75);
  font-size:12px;
  display:flex;
  align-items:center;
  gap:8px;
  opacity:0;
  transition:opacity .2s ease-out, transform .2s ease-out;
  z-index:5;
}
body[data-theme="light"] .toast{
  background:rgba(248,250,252,0.98);
}
.toast.show{
  opacity:1;
  transform:translateX(-50%) translateY(0);
}
.toast-dot{
  width:7px;
  height:7px;
  border-radius:50%;
  background:var(--accent-info);
  box-shadow:0 0 10px rgba(56,189,248,0.9);
}

/* Confetti pieces will be inline styled */
</style>
</head>
<body>

<div class="particle-layer" aria-hidden="true"></div>

<!-- Blob filter and layer -->
<svg width="0" height="0" style="position:absolute">
  <filter id="husky-blob">
    <feGaussianBlur in="SourceGraphic" stdDeviation="22" result="blur" />
    <feColorMatrix
      in="blur"
      mode="matrix"
      values="1 0 0 0 0
              0 1 0 0 0
              0 0 1 0 0
              0 0 0 35 -10"
    />
  </filter>
</svg>

<div class="blob-layer" aria-hidden="true">
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
</div>

<!-- DVD logo bouncing background -->
<div class="dvd-layer" aria-hidden="true">
  <div class="dvd-x">
    <img class="dvd-y" src="https://vgmoose.bdns.dev/dvd_logo.png" alt="dvd" />
  </div>
</div>

<!-- Confetti and toast layers -->
<div id="confetti-layer" aria-hidden="true"></div>
<div id="ea-toast" class="toast" role="status" aria-live="polite">
  <span class="toast-dot"></span>
  <span id="toastText">Emotional status: neutral.</span>
</div>

<div class="main-shell">

  <header class="hero">
    <div class="hero-text">
      <div class="title-chip" id="titleChip" title="Double click for a tiny secret.">
        <span class="icon">üß†</span>
        <span>Emotion analyzer tester</span>
      </div>
      <h1><span>TCSS 142</span> Project 3 Strict Tester</h1>
      <p class="hero-subtitle">
        Paste your full <code>EmotionAnalyzer.java</code>, then run the official strict tests.
        This checks your arrays, weights, formatting, and boundary logic so you can fix problems
        before you submit to Canvas.
      </p>
    </div>
    <div class="hero-meta">
      <div>Class: TCSS 142 Programming Principles</div>
      <div>Project 3, emotion aware text log analyzer</div>
      <div style="margin-top:8px;">
        <button type="button" class="theme-toggle" id="themeToggle">
          <span id="themeIcon">üåô</span>
          <span id="themeLabel">Dark mode</span>
        </button>
      </div>
    </div>
  </header>

  <main class="shell-grid">

    <section class="info-card">
      <h2>How to use this tester</h2>
      <p>Use this page as a quick pre submit check. A clean run here does not replace your own testing, but it helps you catch format and logic issues that the auto grader cares about.</p>

      <ul class="info-mini-list">
        <li>1. Paste the entire contents of <strong>EmotionAnalyzer.java</strong> on the right.</li>
        <li>2. Make sure the file contains <code>public class EmotionAnalyzer</code> and the required methods.</li>
        <li>3. Select <em>Insert template</em> on the right if you want a reminder of the required methods.</li>
        <li>4. Select <em>Run tests</em> and read the output panel for passes or detailed hints.</li>
      </ul>

      <div class="info-pill-row">
        <div class="info-pill">
          <span class="bullet"></span>
          <span>Checks arrays, weights, and method contracts</span>
        </div>
        <div class="info-pill">
          <span class="bullet" style="background: var(--accent-info);"></span>
          <span>Highlights formatting problems in summary output</span>
        </div>
        <div class="info-pill">
          <span class="bullet" style="background: var(--accent-danger); box-shadow: 0 0 10px rgba(248, 113, 113, 0.8);"></span>
          <span>Shows boundary cases and mixed line scores</span>
        </div>
      </div>

      <div class="info-link-row">
        <span>Need the full handout?</span>
        <a
          class="info-link-pill"
          href="https://canvas.uw.edu/courses/1834991/assignments/10837886?module_item_id=25072191"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Open Project 3 assignment on Canvas in a new tab"
        >
          <span>Open Project 3 on Canvas</span>
          <span>‚Üó</span>
        </a>
      </div>
    </section>

    <section class="tester-card">
      <div class="tester-header">
        <div class="small-label">Paste your <code>EmotionAnalyzer.java</code> below</div>
        <div class="status-pill">
          <div class="status-dot" id="statusDot"></div>
          <span id="statusText">Ready to run</span>
        </div>
      </div>

      <textarea id="code" placeholder="// Paste your full EmotionAnalyzer.java here"></textarea>

      <div class="button-row">
        <button class="secondary" type="button" onclick="insertTemplate()">
          <span class="icon">üìã</span>
          <span>Insert template</span>
        </button>
        <button class="primary" type="button" id="runButton" onclick="runTests()">
          <span class="icon" id="runIcon">‚ñ∂</span>
          <span id="runLabel">Run tests</span>
        </button>
        <button class="ghost" type="button" onclick="clearInput()">
          <span class="icon">üßæ</span>
          <span>Clear input</span>
        </button>
        <button class="ghost" type="button" onclick="clearOutput()">
          <span class="icon">üßπ</span>
          <span>Clear output</span>
        </button>
        <button class="ghost" type="button" onclick="copyOutput()">
          <span class="icon">üìÑ</span>
          <span>Copy output</span>
        </button>
        <button class="ghost" type="button" onclick="downloadOutput()">
          <span class="icon">‚¨áÔ∏è</span>
          <span>Download output</span>
        </button>
      </div>

      <div class="kb-shortcuts">
        <strong>Shortcuts:</strong><br><br>

        <span>
          <kbd>Ctrl</kbd> + <kbd>Enter</kbd> (Windows) &nbsp;/&nbsp;
          <kbd>‚åò</kbd> + <kbd>Enter</kbd> (Mac) &nbsp;=&nbsp; Run tests
        </span>
        <br><br>

        <span>
          <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>I</kbd> (Windows) &nbsp;/&nbsp;
          <kbd>‚åò</kbd> + <kbd>Shift</kbd> + <kbd>I</kbd> (Mac) &nbsp;=&nbsp; Clear input
        </span>
        <br><br>

        <span>
          <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>L</kbd> (Windows) &nbsp;/&nbsp;
          <kbd>‚åò</kbd> + <kbd>Shift</kbd> + <kbd>L</kbd> (Mac) &nbsp;=&nbsp; Clear output
        </span>
        <br><br>

        <span>
          <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>T</kbd> (Windows) &nbsp;/&nbsp;
          <kbd>‚åò</kbd> + <kbd>Shift</kbd> + <kbd>T</kbd> (Mac) &nbsp;=&nbsp; Template
        </span>
      </div>

    </section>

  </main>

  <section class="output-card">
    <div class="output-block">
      <div class="output-label-row">
        <span>Tester output (wide view)</span>
        <span class="right">Scroll horizontally and vertically if needed</span>
      </div>
      <pre id="out">(waiting...)</pre>
    </div>
  </section>

  <div class="footer-note" id="footerNote">
    This page runs your code with <code>EmotionAnalyzerTester.java</code> on the server side.
    If you are stuck or the website is not working, please contact <strong>Faiz Ahmed</strong>
    (<a href="mailto:faizahm@uw.edu" style="color:inherit; text-decoration:underline;">faizahm@uw.edu</a>).
  </div>

</div>

<script>
const outEl = document.getElementById("out");
const codeEl = document.getElementById("code");
const statusTextEl = document.getElementById("statusText");
const statusDotEl = document.getElementById("statusDot");
const runButton = document.getElementById("runButton");
const runIcon = document.getElementById("runIcon");
const runLabel = document.getElementById("runLabel");
const themeToggle = document.getElementById("themeToggle");
const themeIcon = document.getElementById("themeIcon");
const themeLabel = document.getElementById("themeLabel");
const particleLayer = document.querySelector(".particle-layer");
const titleChip = document.getElementById("titleChip");
const confettiLayer = document.getElementById("confetti-layer");
const toastEl = document.getElementById("ea-toast");
const toastText = document.getElementById("toastText");
const footerNote = document.getElementById("footerNote");

const docBaseTitle = "TCSS 142 Project 3 Tester ‚Äì EmotionAnalyzer";
let themeToggleCount = 0;
let runCount = 0;
let toastTimer = null;
let todoHintShown = false;

/* ---------- Toast and confetti helpers ---------- */

function playfulToast(msg){
  if (!toastEl) return;
  toastText.textContent = msg;
  toastEl.classList.add("show");
  if (toastTimer) clearTimeout(toastTimer);
  toastTimer = setTimeout(() => {
    toastEl.classList.remove("show");
  }, 2600);
}

function burstConfetti(){
  if (!confettiLayer) return;
  for (let i = 0; i < 40; i++){
    const piece = document.createElement("div");
    piece.style.position = "absolute";
    piece.style.width = "6px";
    piece.style.height = "14px";
    piece.style.borderRadius = "3px";
    const colors = ["#4ade80","#22d3ee","#a855f7","#e5e7eb"];
    piece.style.background = colors[i % colors.length];
    piece.style.left = Math.random() * 100 + "vw";
    piece.style.top = "-24px";
    piece.style.opacity = "0.95";
    const duration = 1200 + Math.random() * 800;
    const translateX = (Math.random() * 2 - 1) * 80;
    const rotate = 360 + Math.random() * 360;
    confettiLayer.appendChild(piece);
    piece.animate(
      [
        { transform: "translate3d(0,0,0) rotate(0deg)", opacity: 1 },
        { transform: "translate3d("+translateX+"px,100vh,0) rotate("+rotate+"deg)", opacity: 0 }
      ],
      { duration, easing: "cubic-bezier(.17,.67,.34,1.01)" }
    );
    setTimeout(() => piece.remove(), duration + 80);
  }
}

/* ---------- Theme handling ---------- */

function applyTheme(theme) {
  document.body.setAttribute("data-theme", theme);
  if (theme === "light") {
    themeIcon.textContent = "‚òÄÔ∏è";
    themeLabel.textContent = "Light mode";
  } else {
    themeIcon.textContent = "üåô";
    themeLabel.textContent = "Dark mode";
  }
}

function toggleTheme() {
  const current = document.body.getAttribute("data-theme") || "dark";
  const next = current === "dark" ? "light" : "dark";
  applyTheme(next);
  themeToggleCount += 1;
  if (themeToggleCount === 5) {
    playfulToast("You toggled themes five times. Tuning the mood of your code is valid.");
  }
  try {
    localStorage.setItem("ea-theme", next);
  } catch (_) {
    // ignore if storage unavailable
  }
}

themeToggle.addEventListener("click", toggleTheme);

(function initThemeFromStorage() {
  let stored = null;
  try {
    stored = localStorage.getItem("ea-theme");
  } catch (_) {
    stored = null;
  }
  applyTheme(stored === "light" ? "light" : "dark");
})();

/* ---------- Particles ---------- */

(function spawnParticles() {
  if (!particleLayer) return;
  const count = 26;
  for (let i = 0; i < count; i++) {
    const p = document.createElement("div");
    p.className = "particle";
    const xStart = Math.random() * 100;
    const xEnd = xStart + (Math.random() * 20 - 10);
    const delay = Math.random() * -18;
    const duration = 18 + Math.random() * 18;
    p.style.setProperty("--x-start", xStart + "vw");
    p.style.setProperty("--x-end", xEnd + "vw");
    p.style.animationDelay = delay + "s";
    p.style.animationDuration = duration + "s";
    particleLayer.appendChild(p);
  }
})();

/* ---------- Status helpers ---------- */

function setStatus(text, mode) {
  statusTextEl.textContent = text;
  if (mode === "running") {
    statusDotEl.style.background = "#38bdf8";
    statusDotEl.style.boxShadow = "0 0 10px rgba(56, 189, 248, 0.9)";
    document.title = "Running tests ¬∑ EmotionAnalyzer";
  } else if (mode === "error") {
    statusDotEl.style.background = "#fb7185";
    statusDotEl.style.boxShadow = "0 0 10px rgba(248, 113, 113, 0.9)";
    document.title = "Check your output ¬∑ EmotionAnalyzer";
  } else {
    statusDotEl.style.background = "#4ade80";
    statusDotEl.style.boxShadow = "0 0 10px rgba(74, 222, 128, 0.9)";
    document.title = docBaseTitle;
  }
}

/* ---------- Required functions ---------- */

function insertTemplate() {
  const tpl = `public class EmotionAnalyzer {
    // Required per Project 3 specification:

    // public static final String[] POS, NEG;
    // public static final int[] PW, NW;

    // public static String normalizeToken(String raw);
    // public static int indexOf(String[] arr, String word);

    // public static int scoreLine(String line,
    //                             String[] pos, int[] posW,
    //                             String[] neg, int[] negW);

    // public static String classify(int score);

    // public static void writeLineResult(java.io.PrintWriter out,
    //                                    int lineNum,
    //                                    int score,
    //                                    String label);

    // public static void writeSummary(java.io.PrintWriter out,
    //                                 int positives, int negatives, int neutrals);

    // public static String promptForExistingFile(java.util.Scanner sc, String prompt);
    // public static char readYesNo(java.util.Scanner sc, String prompt);
}`;
  if (codeEl.value.trim() && !confirm("Replace the current code with a template?")) return;
  codeEl.value = tpl;
  setStatus("Template inserted", "ready");
  playfulToast("Template inserted. Now give those methods some feelings.");
}

async function runTests() {
  const code = codeEl.value;
  if (!code.trim()) {
    alert("Please paste your EmotionAnalyzer.java code first.");
    return;
  }

  runCount += 1;

  const hour = new Date().getHours();
  if (hour >= 23 || hour < 6) {
    footerNote.textContent = "Late night emotion testing detected. Remember to rest as well as compile.";
  } else {
    footerNote.innerHTML =
      'This page runs your code with <code>EmotionAnalyzerTester.java</code> on the server side. ' +
      'If you are stuck or the website is not working, please contact <strong>Faiz Ahmed</strong> ' +
      '(<a href="mailto:faizahm@uw.edu" style="color:inherit; text-decoration:underline;">faizahm@uw.edu</a>).';
  }

  setStatus("Running tests", "running");
  outEl.textContent = "Running tests...";
  runButton.classList.add("is-loading");
  runLabel.textContent = "Running‚Ä¶";

  try {
    const res = await fetch("/run", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ code })
    });

    const text = await res.text();
    const lowered = text.toLowerCase();
    outEl.textContent = text || "(no output)";

    if (res.ok) {
      // Try to guess success vs partial from text content
      if (lowered.includes("all tests passed") || lowered.includes("0 failed") || lowered.includes("all checks passed")) {
        setStatus("Tests finished, everything looks very positive.", "ready");
        burstConfetti();
        playfulToast("All tests passed. Your code is having a great day.");
      } else if (lowered.includes("failed")) {
        setStatus("Tests finished with some failed checks.", "error");
        playfulToast("Some tests failed. The code is a bit moody but still fixable.");
      } else {
        setStatus("Tests finished. Read the details above.", "ready");
      }
    } else {
      setStatus("Tester returned an error", "error");
      playfulToast("Tester returned an error. If it keeps happening, email your TA.");
    }

    if (runCount === 3) {
      playfulToast("Third run already. You are actually doing test driven emotions.");
    } else if (runCount === 10) {
      playfulToast("Ten runs. You and this tester are basically lab partners now.");
    }
  } catch (e) {
    outEl.textContent = "Error: " + e;
    setStatus("Network or server error", "error");
    playfulToast("Network or server error. The tester is feeling offline.");
  } finally {
    runButton.classList.remove("is-loading");
    runLabel.textContent = "Run tests";
    runIcon.textContent = "‚ñ∂";
  }
}

function clearOutput() {
  outEl.textContent = "(waiting...)";
  setStatus("Ready to run", "ready");
}

/* ---------- New helpers: input, copy and download ---------- */

function clearInput() {
  codeEl.value = "";
  setStatus("Input cleared", "ready");
}

function copyOutput() {
  const text = outEl.textContent || "";
  if (!text.trim()) {
    alert("There is no output to copy yet.");
    return;
  }
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(text).then(
      () => setStatus("Output copied to clipboard", "ready"),
      () => alert("Could not copy to clipboard. Please copy manually.")
    );
  } else {
    const temp = document.createElement("textarea");
    temp.value = text;
    document.body.appendChild(temp);
    temp.select();
    try {
      document.execCommand("copy");
      setStatus("Output copied to clipboard", "ready");
    } catch (_) {
      alert("Could not copy to clipboard. Please copy manually.");
    }
    document.body.removeChild(temp);
  }
}

function downloadOutput() {
  const text = outEl.textContent || "";
  if (!text.trim()) {
    alert("There is no output to download yet.");
    return;
  }
  const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "tester-output.txt";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  setStatus("Output downloaded", "ready");
}

/* ---------- Keyboard shortcuts ---------- */
/*
  Ctrl or Command + Enter      -> runTests()
  Ctrl or Command + Shift + I  -> clearInput()
  Ctrl or Command + Shift + L  -> clearOutput()
  Ctrl or Command + Shift + T  -> insertTemplate()
*/
document.addEventListener("keydown", function(e) {
  const meta = e.ctrlKey || e.metaKey;
  if (!meta) return;

  const key = e.key.toLowerCase();
  const shift = e.shiftKey;

  if (!shift && key === "enter") {
    e.preventDefault();
    runTests();
  } else if (shift && key === "i") {
    e.preventDefault();
    clearInput();
  } else if (shift && key === "l") {
    e.preventDefault();
    clearOutput();
  } else if (shift && key === "t") {
    e.preventDefault();
    insertTemplate();
  }
});

/* ---------- Tiny easter eggs ---------- */

// Double click on the title chip for a dev credit hint
if (titleChip) {
  titleChip.addEventListener("dblclick", () => {
    playfulToast("Secret note: this strict tester was coded by TA Faiz for TCSS 142.");
  });
}

// Spot TODO or fix me markers once
codeEl.addEventListener("input", () => {
  if (!todoHintShown && /TODO|fix ?me/i.test(codeEl.value)) {
    todoHintShown = true;
    setStatus("Spotted a TODO in your code. The feelings are a bit mixed.", "ready");
  }
});

/* ---------- Husky Purple Blob Cursor JS ---------- */

(function(){
  const dots = Array.from(document.querySelectorAll('.blob-dot'));
  if (!dots.length) return;

  const nodes = dots.map(() => ({
    x: window.innerWidth / 2,
    y: window.innerHeight / 2
  }));

  let targetX = window.innerWidth / 2;
  let targetY = window.innerHeight / 2;

  const speeds = [0.20, 0.16, 0.14, 0.12, 0.10, 0.08];

  function animateBlob() {
    nodes[0].x += (targetX - nodes[0].x) * speeds[0];
    nodes[0].y += (targetY - nodes[0].y) * speeds[0];

    for (let i = 1; i < nodes.length; i++) {
      nodes[i].x += (nodes[i-1].x - nodes[i].x) * speeds[i];
      nodes[i].y += (nodes[i-1].y - nodes[i].y) * speeds[i];
    }

    nodes.forEach((node, i) => {
      dots[i].style.transform =
        'translate3d(' + node.x + 'px,' + node.y + 'px,0) translate3d(-50%,-50%,0)';
    });

    requestAnimationFrame(animateBlob);
  }

  window.addEventListener('pointermove', (e) => {
    targetX = e.clientX;
    targetY = e.clientY;
  });

  window.addEventListener('touchmove', (e) => {
    const t = e.touches[0];
    if (!t) return;
    targetX = t.clientX;
    targetY = t.clientY;
  }, { passive: true });

  window.addEventListener('resize', () => {
    if (!nodes.length) return;
    const cx = window.innerWidth / 2;
    const cy = window.innerHeight / 2;
    targetX = cx;
    targetY = cy;
    nodes.forEach(n => { n.x = cx; n.y = cy; });
  });

  animateBlob();
})();
</script>
</body>
</html>
